\section{Grammar}
\label{sec:grammar}

A Naigama grammar file or buffer consists either of a single
unnamed expression, or of a sequence of named expressions (called rules),
whitespace and comments, denoted in ASCII text.
Naigama grammar is defined with the express purpose of matching, validating
and/or capturing from an arbitrary data input.
Naigama grammar is taken by the Naigama compiler program (naic) and turned
into Naigama assembly [section \ref{sec:assembly}].

\begin{myquote}
\begin{verbatim}
-- JSON; JavaScript Object Notation.
TOP          <- JSON
__prefix     <- %s*
JSON         <- HASH END
HASH         <- CBOPEN OPTHASHELTS CBCLOSE
OPTHASHELTS  <- HASHELTS / ...
HASHELTS     <- HASHELT COMMA HASHELTS / HASHELT
HASHELT      <- STRING COLON VALUE
ARRAY        <- ABOPEN OPTARRAYELTS ABCLOSE
OPTARRAYELTS <- ARRAYELTS / ...
ARRAYELTS    <- VALUE COMMA ARRAYELTS / VALUE
VALUE        <- STRING / FLOAT / INT / BOOL / NULL / HASH / ARRAY
STRING       <- { '"' ( '\\' ([nrtv"] / [0-9]^3) / [^"\\] )* '"' }
INT          <- { [0-9]+ }
FLOAT        <- { [0-9]* '.' [0-9]+ }
BOOL         <- { 'true' / 'false' }
NULL         <- { 'null' }
CBOPEN       <- '{'
CBCLOSE      <- '}'
ABOPEN       <- '['
ABCLOSE      <- ']'
COMMA        <- ','
COLON        <- ':'
END          <- !.
\end{verbatim}
\end{myquote}
\textit{Example of a Naigama grammar meant to validate and capture from
JSON\cite{bib:json} text.}

\subsection{Rules}

A rule is defined as an \textit{Identifier}, followed by a
left-pointing arrow (composed of a less-than and a minus sign),
followed by a matching expression.

When a Naigama grammar consists of a sequence of rules
(as opposed to a single line expression),
the first rule is used as the starting point for matching inputs.

\begin{myquote}
\begin{verbatim}
RULE1 <- 'a' / RULE2
RULE2 <- 'b' / RULE3
RULE3 <- 'c'
\end{verbatim}
\end{myquote}
\textit{Definition of a set of rules}

\subsubsection{Identifiers}

Identifiers, in Naigama, are defined as a combination of letters,
numbers and the underscore character, not starting with a number,
of between one and 64 characters long.

\begin{myquote}
\begin{verbatim}
IDENTIFIER <- [a-zA-Z_][a-zA-Z0-9_]^-63
\end{verbatim}
\end{myquote}
\textit{Definition of an identifier}

Identifiers are used to start rule definitions, and as references
to rules in expressions.

\subsubsection{Special Rules}

There is currently one special rule in Naigama grammar: a rule called
'\_\_prefix' will be treated specially. This rule will be, from its
definition onwards, called before the execution of any subsequent rule
definition expression. The aim is to make whitespace and comment filtering
in program language parsing easier. See also the earlier 'JSON' grammar
example.

\subsection{Expressions}

Expressions are lists of terms, optionally separated by the
OR operator (denoted by the forward slash sign).

\subsection{Terms}

\subsection{Matchers}

\subsubsection{NOT and AND Modifiers}

\subsubsection{Quantifiers}

\subsubsection{The ANY Matcher}

The ANY matcher also allows you to define end-of-input, like so:

\begin{myquote}
\begin{verbatim}
ENDOFINPUT <- !.
\end{verbatim}
\end{myquote}
\textit{Definition of end-of-input}

\subsubsection{The SET Matcher}

\subsubsection{The STRING Matcher}

\subsubsection{The BITMASK Matcher}

\subsubsection{The HEXLITERAL Matcher}

\subsubsection{The VARCAPTURE Matcher}

\subsubsection{The CAPTURE Matcher}

\subsubsection{The GROUP Matcher}

\subsubsection{The MACRO Matcher}

\subsubsection{The VARREFERENCE Matcher}

\subsubsection{The REFERENCE Matcher}

