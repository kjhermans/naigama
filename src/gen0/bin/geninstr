#!/usr/bin/perl

my $instrfile = shift @ARGV;
my $instrtext = `cat $instrfile`;
my $instrhash = eval $instrtext;

print "#ifndef _INSTRUCTIONS_H_
#define _INSTRUCTIONS_H_
";

my $dsec = '';
my $csec = "#define INSTRCASES \\\n";

foreach my $instr (sort(keys(%{$instrhash}))) {
  $dsec .= "#define OPCODE_" . uc($instr) .
           " 0x" . $instrhash->{$instr}{opcode} . "\n";
  $csec .= "  case OPCODE_" . uc($instr) . ": return \"".uc($instr)."\";\\\n";
}
$csec .= "  default: return \"Unknown opcode\";\n";

print "\n" . $dsec . "\n" . $csec . "\n";

print "#endif\n";

1;
